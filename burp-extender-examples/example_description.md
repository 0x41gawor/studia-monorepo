# Custom Scanner checks

In the `8. Custom Scan Insertion Points` example, we saw how an extension could be used to provide custom insertion points for use by Burp Scanner, enabling you to run the Scanner's built-in checks against entry points within serialized data or other formats that Burp does not natively support. In this example, we'll see how an extension can be used to further extend the Scanner's behavior, by providing custom checks for passive and active scanning.



Custom scan checks are tightly integrated within Burp's scanning engine, and are invoked at the relevant stage for each base request and insertion point that the user sends for scanning. They can perform arbitrary processing, issue their own requests (when actively scanning), and report their own custom scan issues.



## In this example

For the sake of this example, we've updated the demo serialized input application to contain two fictitious vulnerabilities that our extension can check for:

- An information leakage vulnerability where a content management system is copying sensitive data into some application responses.
  - It copies ` "Page generated by:"`;
- An input vulnerability where submitting the pipe character results in a distinctive error message, indicating an exploitable condition.
  - This is pipe character: `"|"`;

## Passive vs Active Scanning

**Passive** - only analyzing responses.

**Active** - sending additional requests to get more responses to analyze.

## `IScanIssue`

After scan is done, Burp print out scan issues details (if there are any).

In Java we express such details in a class implementing `IScanIssue` interface.

## How does Burp work in this example

When we are performing a scan Burp just sends tons of HTTP requests.

- After receiving a *HTTP response* Burp sends it to `IScannerCheck` method `doPassiveScan`.
  - This method analyzes the *HTTP response* and generates the list of `IScanIssue`.

- For each *HTTP request* Burp checks if it matches some `IScannerInsertionPoints`, if so Burp sends such pair to`IScannerCheck` method `doActiveScan`.
  - Here method defines some *payload* and uses `IScannerInsertionPoints.buildRequest(payload)` method to send additional *HTTP request*.
  - Then method analyzes the *HTTP response*

